# מסמך הסבר טכני - תכונת תרגום והתאמה למובייל

## 📋 תוכן עניינים
1. [מערכת התרגום הדו-לשונית](#מערכת-התרגום-הדו-לשונית)
2. [זיהוי אוטומטי של מדינה](#זיהוי-אוטומטי-של-מדינה)
3. [התאמה למובייל](#התאמה-למובייל)
4. [קבצים שהשתנו](#קבצים-שהשתנו)

---

## 🌐 מערכת התרגום הדו-לשונית

### שלב 1: יצירת מבנה התרגומים (script.js)

נוסף אובייקט תרגומים המכיל את כל הטקסטים בעברית ואנגלית:

```javascript
const translations = {
    he: {
        'main-title': '🧩 משחק הזיכרון',
        'subtitle': 'בחר נושא ואתחל לשחק!',
        'theme-harry-potter': '⚡ גיבורי הארי פוטר',
        // ... עוד תרגומים
    },
    en: {
        'main-title': '🧩 Memory Game',
        'subtitle': 'Choose a theme and start playing!',
        'theme-harry-potter': '⚡ Harry Potter Heroes',
        // ... עוד תרגומים
    }
};
```

**הסבר:**
- האובייקט מאורגן לפי שפות (he/en)
- כל טקסט מזוהה באמצעות מפתח ייחודי (key)
- המפתחות זהים בשתי השפות, רק הערכים שונים

### שלב 2: פונקציית עדכון השפה (script.js)

```javascript
function updatePageLanguage() {
    // מחפש את כל האלמנטים עם תכונת data-i18n
    const elements = document.querySelectorAll('[data-i18n]');

    // עובר על כל אלמנט ומעדכן את התוכן שלו
    elements.forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[currentLanguage][key]) {
            element.textContent = translations[currentLanguage][key];
        }
    });

    // מעדכן את כיווניות הדף (RTL/LTR)
    document.documentElement.lang = currentLanguage;
    document.documentElement.dir = currentLanguage === 'he' ? 'rtl' : 'ltr';

    // מעדכן את טקסט כפתור החלפת השפה
    const languageToggle = document.getElementById('languageToggle');
    if (languageToggle) {
        languageToggle.textContent = currentLanguage === 'he' ? 'English' : 'עברית';
    }

    // מעדכן את שם הנושא אם המשחק פעיל
    if (game.theme && game.themeName) {
        const themeNameKey = `theme-name-${game.theme}`;
        if (translations[currentLanguage][themeNameKey]) {
            game.themeName = translations[currentLanguage][themeNameKey];
            const themeNameElement = document.getElementById('themeName');
            if (themeNameElement) {
                themeNameElement.textContent = game.themeName;
            }
        }
    }
}
```

**הסבר שלב-אחר-שלב:**
1. **מציאת אלמנטים:** `querySelectorAll('[data-i18n]')` מוצא את כל האלמנטים שסומנו לתרגום
2. **עדכון תוכן:** עבור כל אלמנט, הפונקציה מחליפה את הטקסט לפי השפה הנוכחית
3. **כיווניות:** משנה את כיוון הטקסט (עברית מימין לשמאל, אנגלית משמאל לימין)
4. **כפתור השפה:** מעדכן את הטקסט בכפתור להיפך מהשפה הנוכחית
5. **שם נושא:** מעדכן את שם נושא המשחק אם המשחק פעיל

### שלב 3: סימון אלמנטים ב-HTML (index.html)

כל אלמנט שצריך תרגום קיבל תכונה `data-i18n`:

```html
<!-- לפני -->
<h1>🧩 משחק הזיכרון</h1>

<!-- אחרי -->
<h1 data-i18n="main-title">🧩 משחק הזיכרון</h1>
```

**הסבר:**
- `data-i18n="main-title"` מסמן שאלמנט זה צריך תרגום
- הערך `"main-title"` מצביע על המפתח באובייקט התרגומים
- התוכן הראשוני נשאר בעברית (default)

### שלב 4: לחצן החלפת שפה

#### HTML (index.html):
```html
<button class="language-toggle" id="languageToggle">English</button>
```

#### CSS (style.css):
```css
.language-toggle {
    position: fixed;
    top: 20px;
    right: 20px;
    background: linear-gradient(135deg, hsl(240, 42%, 39%, 85%) 0%, hsla(300, 75%, 23%, 85%) 100%);
    color: white;
    border: 2px solid hsla(0, 0%, 100%, 0.3);
    border-radius: 25px;
    padding: 10px 20px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    z-index: 1000;
    box-shadow: 0 4px 15px hsla(0, 0%, 0%, 0.3);
    transition: all 0.3s ease;
}

.language-toggle:hover {
    background: linear-gradient(135deg, hsl(240, 42%, 39%) 0%, hsl(300, 75%, 23%) 100%);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px hsla(0, 0%, 0%, 0.4);
}
```

**הסבר עיצוב:**
- `position: fixed` - הכפתור צמוד למסך ולא נע עם הגלילה
- `top: 20px; right: 20px` - מיקום בפינה הימנית העליונה
- `z-index: 1000` - מבטיח שהכפתור יהיה מעל כל האלמנטים
- `transition` - אנימציה חלקה ב-hover

#### JavaScript (script.js):
```javascript
// בתוך DOMContentLoaded
const languageToggle = document.getElementById('languageToggle');
languageToggle.addEventListener('click', () => {
    const newLanguage = currentLanguage === 'he' ? 'en' : 'he';
    changeLanguage(newLanguage);
});
```

**הסבר:**
- מאזין ללחיצה על הכפתור
- מחליף בין 'he' ל-'en'
- קורא לפונקציית `changeLanguage()` שמפעילה את `updatePageLanguage()`

---

## 🌍 זיהוי אוטומטי של מדינה

### פונקציית זיהוי (script.js):

```javascript
async function detectCountryAndSetLanguage() {
    try {
        // קריאה ל-API שמזהה מיקום לפי IP
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        const countryCode = data.country_code;

        // אם ישראל - עברית, אחרת - אנגלית
        if (countryCode === 'IL') {
            currentLanguage = 'he';
        } else {
            currentLanguage = 'en';
        }
    } catch (error) {
        // במקרה של שגיאה - ברירת מחדל לעברית
        console.log('Country detection failed, using default language');
        currentLanguage = 'he';
    }

    // מעדכן את כל הדף לפי השפה שנבחרה
    updatePageLanguage();
}
```

**הסבר מפורט:**

1. **קריאה ל-API:**
   - משתמש ב-`ipapi.co` - שירות חינמי שמזהה מדינה לפי כתובת IP
   - מחזיר אובייקט JSON עם מידע גיאוגרפי
   - `countryCode` מכיל קוד בן 2 אותיות של המדינה (IL = ישראל)

2. **לוגיקת החלטה:**
   - בודק אם קוד המדינה הוא 'IL'
   - אם כן → עברית
   - אם לא → אנגלית
   - טיפול בשגיאות: אם הבקשה נכשלת, ברירת מחדל לעברית

3. **הפעלה בטעינת הדף:**
```javascript
document.addEventListener("DOMContentLoaded", () => {
    // זה הדבר הראשון שקורה בטעינת הדף
    detectCountryAndSetLanguage();

    // שאר האירועים...
});
```

**למה זה עובד:**
- ה-API מזהה את ה-IP של המשתמש
- ממפה אותו למדינה
- מחזיר קוד מדינה
- הקוד פועל אוטומטית לפני שהמשתמש רואה את הדף

---

## 📱 התאמה למובייל

### Media Query ב-CSS (style.css):

```css
/* Mobile Responsiveness */
@media (max-width: 768px) {
    /* התאמת כפתור השפה */
    .language-toggle {
        top: 10px;
        right: 10px;
        padding: 8px 15px;
        font-size: 12px;
    }

    /* התאמת פוטר */
    .footer {
        padding: 12px 10px;
    }

    .footer-container {
        flex-direction: column;  /* שינוי מעמודות לשורה */
        gap: 12px;
    }

    /* התאמת כרטיסים בפוטר */
    .creator-card, .contact-card, .copyright-card {
        height: auto;
        padding: 12px;
        min-height: 70px;
    }

    .contact-card {
        gap: 6px;
    }

    .contact-card h4 {
        font-size: 14px;
    }

    .phone-link, .email-link {
        font-size: 13px;
    }

    .copyright-card p {
        font-size: 12px;
    }

    .info h4 {
        font-size: 14px;
    }

    .info p {
        font-size: 11px;
    }
}
```

**הסבר שלב-אחר-שלב:**

### 1. Media Query - מה זה?
```css
@media (max-width: 768px) {
    /* קוד שיופעל רק במסכים עד 768 פיקסלים */
}
```
- **768px** = נקודת שבירה רגילה בין מחשב לטאבלט/מובייל
- כל הסגנונות בתוך ה-media query יחליפו את הסגנונות הרגילים במסכים קטנים

### 2. התאמת כפתור השפה
```css
.language-toggle {
    top: 10px;      /* במקום 20px - קרוב יותר לקצה */
    right: 10px;    /* במקום 20px - חוסך מקום */
    padding: 8px 15px;  /* במקום 10px 20px - כפתור קטן יותר */
    font-size: 12px;    /* במקום 14px - טקסט קטן יותר */
}
```

### 3. התאמת פוטר
```css
.footer {
    padding: 12px 10px;  /* פדינג קטן יותר */
}

.footer-container {
    flex-direction: column;  /* במקום row - כרטיסים אחד מתחת לשני */
    gap: 12px;              /* רווח קטן יותר בין כרטיסים */
}
```

**הסבר מושג Flexbox:**
- **desktop:** `flex-direction: row` → כרטיסים בשורה אופקית
- **mobile:** `flex-direction: column` → כרטיסים בעמודה אנכית

```
Desktop:  [Card 1] [Card 2] [Card 3]

Mobile:   [Card 1]
          [Card 2]
          [Card 3]
```

### 4. התאמת כרטיסים
```css
.creator-card, .contact-card, .copyright-card {
    height: auto;        /* גובה דינמי לפי תוכן */
    padding: 12px;       /* פדינג קטן יותר */
    min-height: 70px;    /* גובה מינימלי */
}
```

**למה `height: auto`?**
- במסך גדול הכרטיסים בגובה קבוע (110px)
- במובייל הם צריכים להתאים לתוכן
- `min-height: 70px` מבטיח מינימום

### 5. התאמת טקסטים
```css
.contact-card h4 {
    font-size: 14px;  /* במקום הגודל המקורי */
}

.phone-link, .email-link {
    font-size: 13px;  /* קטן יותר */
}
```

**עיקרון כללי:**
- כל הגדלים צומצמו ב-20-30% למובייל
- שמירה על קריאות
- חיסכון במקום מסך

---

## 🛠️ תהליך העבודה המלא

### זרימת הקוד בטעינת הדף:

```
1. הדף נטען
   ↓
2. DOMContentLoaded נורה
   ↓
3. detectCountryAndSetLanguage() מופעלת
   ↓
4. קריאה ל-API
   ↓
5. קבלת קוד מדינה (IL או אחר)
   ↓
6. currentLanguage = 'he' או 'en'
   ↓
7. updatePageLanguage() מופעלת
   ↓
8. עדכון כל הטקסטים בדף
   ↓
9. עדכון כיווניות (RTL/LTR)
   ↓
10. עדכון כפתור השפה
```

### זרימת לחיצה על כפתור השפה:

```
1. משתמש לוחץ על כפתור
   ↓
2. Event listener מזוהה
   ↓
3. currentLanguage משתנה (he ↔ en)
   ↓
4. changeLanguage() מופעלת
   ↓
5. updatePageLanguage() מופעלת שוב
   ↓
6. כל הטקסטים מתעדכנים לשפה החדשה
```

---

## 📂 קבצים שהשתנו

### 1. index.html
**שינויים:**
- הוספת `<button class="language-toggle">` בתחילת ה-body
- הוספת `data-i18n` ל-26 אלמנטים

**דוגמה:**
```html
<!-- לפני -->
<h1>🧩 משחק הזיכרון</h1>

<!-- אחרי -->
<h1 data-i18n="main-title">🧩 משחק הזיכרון</h1>
```

### 2. script.js
**שינויים:**
- הוספת 117 שורות קוד חדשות בתחילת הקובץ
- פונקציות חדשות:
  - `detectCountryAndSetLanguage()`
  - `changeLanguage(lang)`
  - `updatePageLanguage()`
- עדכון `loadThemeData()` לשימוש בתרגומים
- עדכון `handleGameError()` לשימוש בתרגומים
- עדכון `DOMContentLoaded` להוספת event listener לכפתור

### 3. style.css
**שינויים:**
- הוספת סגנון ל-`.language-toggle` (23 שורות)
- הוספת `.right-container` (4 שורות)
- הוספת media query למובייל (44 שורות)

**סיכום שינויים:**
```
index.html:  +29 שורות (הוספת attributes ולחצן)
script.js:   +117 שורות (מערכת תרגום מלאה)
style.css:   +71 שורות (עיצוב ולחצן + מובייל)
────────────
סה"כ:        +217 שורות קוד
```

---

## 🎯 סיכום תכונות

### ✅ מה בוצע:

1. **מערכת תרגום דו-לשונית (עברית/אנגלית)**
   - 26 אלמנטים מתורגמים אוטומטית
   - שינוי כיווניות אוטומטי (RTL/LTR)
   - שמירת אימוג'י והפורמט המקורי

2. **לחצן החלפת שפה**
   - ממוקם בפינה הימנית העליונה
   - מציג את השפה הבאה (אם עברית → מציג "English")
   - עובד בכל מסך (דסקטופ/מובייל)

3. **זיהוי אוטומטי של מדינה**
   - מזהה IP של המשתמש
   - קובע שפה: ישראל = עברית, אחרת = אנגלית
   - ברירת מחדל: עברית (במקרה של שגיאה)

4. **התאמה למובייל**
   - פוטר מוצג בעמודה (לא בשורה)
   - גדלים מותאמים למסך קטן
   - כפתור שפה קטן וקרוב לפינה
   - שמירה על פונקציונליות hover של הפוטר

---

## 🔧 טכנולוגיות בשימוש

- **HTML5** - סמנטיקה ו-data attributes
- **CSS3** - Media queries, Flexbox, Gradients
- **JavaScript ES6+** - Async/Await, Arrow functions, Template literals
- **API חיצוני** - ipapi.co לזיהוי מיקום

---

## 📌 הערות חשובות

1. **ללא תלות חיצונית**: כל הקוד נכתב ב-Vanilla JavaScript, ללא ספריות חיצוניות
2. **ביצועים**: הקוד אופטימלי ופועל בצורה חלקה
3. **תחזוקה**: הוספת שפה נוספת דורשת רק הוספת מפתח ל-`translations`
4. **נגישות**: שינוי כיווניות אוטומטי תומך ב-screen readers

---

**תאריך:** ינואר 2026
**גרסה:** 1.0
**מפתח:** Samuel Tzvi
